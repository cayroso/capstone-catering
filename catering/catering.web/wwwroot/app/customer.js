!function(e){function t(t){for(var a,s,i=t[0],l=t[1],c=t[2],m=0,d=[];m<i.length;m++)s=i[m],r[s]&&d.push(r[s][0]),r[s]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);for(u&&u(t);d.length;)d.shift()();return o.push.apply(o,c||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],a=!0,i=1;i<n.length;i++){var l=n[i];0!==r[l]&&(a=!1)}a&&(o.splice(t--,1),e=s(s.s=n[0]))}return e}var a={},r={2:0},o=[];function s(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=a,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(n,a,function(t){return e[t]}.bind(null,a));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/app/";var i=window.webpackJsonp=window.webpackJsonp||[],l=i.push.bind(i);i.push=t,i=i.slice();for(var c=0;c<i.length;c++)t(i[c]);var u=l;o.push([154,0]),n()}({131:function(e,t,n){var a={"./af":3,"./af.js":3,"./ar":4,"./ar-dz":5,"./ar-dz.js":5,"./ar-kw":6,"./ar-kw.js":6,"./ar-ly":7,"./ar-ly.js":7,"./ar-ma":8,"./ar-ma.js":8,"./ar-sa":9,"./ar-sa.js":9,"./ar-tn":10,"./ar-tn.js":10,"./ar.js":4,"./az":11,"./az.js":11,"./be":12,"./be.js":12,"./bg":13,"./bg.js":13,"./bm":14,"./bm.js":14,"./bn":15,"./bn.js":15,"./bo":16,"./bo.js":16,"./br":17,"./br.js":17,"./bs":18,"./bs.js":18,"./ca":19,"./ca.js":19,"./cs":20,"./cs.js":20,"./cv":21,"./cv.js":21,"./cy":22,"./cy.js":22,"./da":23,"./da.js":23,"./de":24,"./de-at":25,"./de-at.js":25,"./de-ch":26,"./de-ch.js":26,"./de.js":24,"./dv":27,"./dv.js":27,"./el":28,"./el.js":28,"./en-SG":29,"./en-SG.js":29,"./en-au":30,"./en-au.js":30,"./en-ca":31,"./en-ca.js":31,"./en-gb":32,"./en-gb.js":32,"./en-ie":33,"./en-ie.js":33,"./en-il":34,"./en-il.js":34,"./en-nz":35,"./en-nz.js":35,"./eo":36,"./eo.js":36,"./es":37,"./es-do":38,"./es-do.js":38,"./es-us":39,"./es-us.js":39,"./es.js":37,"./et":40,"./et.js":40,"./eu":41,"./eu.js":41,"./fa":42,"./fa.js":42,"./fi":43,"./fi.js":43,"./fo":44,"./fo.js":44,"./fr":45,"./fr-ca":46,"./fr-ca.js":46,"./fr-ch":47,"./fr-ch.js":47,"./fr.js":45,"./fy":48,"./fy.js":48,"./ga":49,"./ga.js":49,"./gd":50,"./gd.js":50,"./gl":51,"./gl.js":51,"./gom-latn":52,"./gom-latn.js":52,"./gu":53,"./gu.js":53,"./he":54,"./he.js":54,"./hi":55,"./hi.js":55,"./hr":56,"./hr.js":56,"./hu":57,"./hu.js":57,"./hy-am":58,"./hy-am.js":58,"./id":59,"./id.js":59,"./is":60,"./is.js":60,"./it":61,"./it-ch":62,"./it-ch.js":62,"./it.js":61,"./ja":63,"./ja.js":63,"./jv":64,"./jv.js":64,"./ka":65,"./ka.js":65,"./kk":66,"./kk.js":66,"./km":67,"./km.js":67,"./kn":68,"./kn.js":68,"./ko":69,"./ko.js":69,"./ku":70,"./ku.js":70,"./ky":71,"./ky.js":71,"./lb":72,"./lb.js":72,"./lo":73,"./lo.js":73,"./lt":74,"./lt.js":74,"./lv":75,"./lv.js":75,"./me":76,"./me.js":76,"./mi":77,"./mi.js":77,"./mk":78,"./mk.js":78,"./ml":79,"./ml.js":79,"./mn":80,"./mn.js":80,"./mr":81,"./mr.js":81,"./ms":82,"./ms-my":83,"./ms-my.js":83,"./ms.js":82,"./mt":84,"./mt.js":84,"./my":85,"./my.js":85,"./nb":86,"./nb.js":86,"./ne":87,"./ne.js":87,"./nl":88,"./nl-be":89,"./nl-be.js":89,"./nl.js":88,"./nn":90,"./nn.js":90,"./pa-in":91,"./pa-in.js":91,"./pl":92,"./pl.js":92,"./pt":93,"./pt-br":94,"./pt-br.js":94,"./pt.js":93,"./ro":95,"./ro.js":95,"./ru":96,"./ru.js":96,"./sd":97,"./sd.js":97,"./se":98,"./se.js":98,"./si":99,"./si.js":99,"./sk":100,"./sk.js":100,"./sl":101,"./sl.js":101,"./sq":102,"./sq.js":102,"./sr":103,"./sr-cyrl":104,"./sr-cyrl.js":104,"./sr.js":103,"./ss":105,"./ss.js":105,"./sv":106,"./sv.js":106,"./sw":107,"./sw.js":107,"./ta":108,"./ta.js":108,"./te":109,"./te.js":109,"./tet":110,"./tet.js":110,"./tg":111,"./tg.js":111,"./th":112,"./th.js":112,"./tl-ph":113,"./tl-ph.js":113,"./tlh":114,"./tlh.js":114,"./tr":115,"./tr.js":115,"./tzl":116,"./tzl.js":116,"./tzm":117,"./tzm-latn":118,"./tzm-latn.js":118,"./tzm.js":117,"./ug-cn":119,"./ug-cn.js":119,"./uk":120,"./uk.js":120,"./ur":121,"./ur.js":121,"./uz":122,"./uz-latn":123,"./uz-latn.js":123,"./uz.js":122,"./vi":124,"./vi.js":124,"./x-pseudo":125,"./x-pseudo.js":125,"./yo":126,"./yo.js":126,"./zh-cn":127,"./zh-cn.js":127,"./zh-hk":128,"./zh-hk.js":128,"./zh-tw":129,"./zh-tw.js":129};function r(e){var t=o(e);return n(t)}function o(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}r.keys=function(){return Object.keys(a)},r.resolve=o,e.exports=r,r.id=131},140:function(e,t,n){},154:function(e,t,n){"use strict";n.r(t);n(140);var a=n(1),r=n.n(a),o=(n(130),n(132),n(134),n(2)),s=n.n(o);n(135);const i=s.a.module("app",[n(136),n(137),"ui.bootstrap"]);i.config(function(){});var l=i;function c(e){this.hi=function(){alert("index controller")};var t="Home/Index/?handler=Reservations";e.get(t).then(function(e){let t=[];for(var n=0;n<e.data.length;n++){var a=e.data[n];t.push({title:a.title,start:r.a.fullCalendar.moment(a.dateStart),end:r.a.fullCalendar.moment(a.dateEnd)})}r()("#calendar").fullCalendar({header:{center:"month,agendaWeek"},defaultView:"month",minTime:"07:00:00",maxTime:"22:59:00",events:t})},function(e){})}function u(e){}c.$inject=["$http"],l.controller("indexController",c),u.$inject=["toastr"],l.controller("mainController",u);var m=n(0),d=n.n(m);function f(e,t){var n=this,a=new Date,o=new Date(a.getFullYear(),a.getMonth(),a.getDate()+1,a.getHours()),s=new Date(a.getFullYear(),a.getMonth(),a.getDate()+1,a.getHours());n.formData={title:"",venue:"",starterCount:0,mainCount:0,drinkCount:0,startDate:new Date(o),startTime:new Date(o),endDate:new Date(s),endTime:new Date(s)},n.lookups={packages:[],starters:[],mains:[],drinks:[]},n.setPackage=function(e){n.formData.package!==e&&n.reset()},n.reset=function(){n.pricing=angular.copy(n.originalPricing)},n.checkAvailability=function(){var a=n.formData.startDate,r=n.formData.startTime,o=d()(new Date(a.getFullYear(),a.getMonth(),a.getDate(),r.getHours(),r.getMinutes(),0,0)).utc().valueOf(),s=n.formData.startDate,i=n.formData.startTime,l=`api/reservations/availability/?startTicks=${o}&endTicks=${d()(new Date(s.getFullYear(),s.getMonth(),s.getDate(),i.getHours(),i.getMinutes(),0,0)).utc().valueOf()}`;e.get(l).then(function(e){t.info("Dates are Available: "+e.data.message,"Succes",{timeOut:0})},function(e){t.warning(e.data,"Failed",{timeOut:0})})},n.calculate=function(){var e=n.pricing,t=0;t+=e.plate*e.plateCount||0,t+=e.spoon*e.spoonCount||0,t+=e.fork*e.forkCount||0,t+=e.glass*e.glassCount||0,t+=e.chair*e.chairCount||0,t+=e.table*e.tableCount||0,t+=e.fixedCost+e.fixedLabor,e.hasFlower&&(t+=e.flower),e.hasSoundSystem&&(t+=e.soundSystem),e.total=t},n.autoAllocate=function(){var e=n.pricing;e.plateCount=e.guestCount,e.spoonCount=e.guestCount,e.forkCount=e.guestCount,e.glassCount=e.guestCount,e.chairCount=e.guestCount,e.tableCount=Math.ceil(e.guestCount/4),e.hasFlower=!0,e.hasSoundSystem=!0,n.calculate()},n.processForm=function(e){var a=n.formData;if(""!==a.title)if(""!==a.venue){for(var o=n.pricing,s=[],i=0;i<n.formData.package.images.length;i++){var l=n.formData.package.images[i];!0===l.selected&&s.push(l.packageImageId)}var c=n.formData.startDate,u=n.formData.startTime,m=d()(new Date(c.getFullYear(),c.getMonth(),c.getDate(),u.getHours(),u.getMinutes(),0,0)).utc().valueOf(),f=n.formData.endDate,p=n.formData.endTime,j=d()(new Date(f.getFullYear(),f.getMonth(),f.getDate(),p.getHours(),p.getMinutes(),0,0)).utc().valueOf(),g={packageId:n.formData.package.packageId,title:a.title,venue:a.venue,guestCount:o.guestCount,plateCount:o.plateCount,platePrice:o.plate,spoonCount:o.spoonCount,spoonPrice:o.spoon,forkCount:o.forkCount,forkPrice:o.fork,glassCount:o.glassCount,glassPrice:o.glass,chairCount:o.chairCount,chairPrice:o.chair,tableCount:o.tableCount,tablePrice:o.table,hasFlower:o.hasFlower,flowerPrice:o.flower,hasSoundSystem:o.hasSoundSystem,soundSystemPrice:o.soundSystem,fixedCost:o.fixedCost,fixedLabor:o.fixedLabor,dateStartTicks:m,dateEndTicks:j,packageImageIds:s,notes:n.formData.notes};r.a.ajax({url:"Reservations/?handler=Reservation",type:"POST",contentType:"application/json; charset=utf-8",headers:{RequestVerificationToken:r()('input:hidden[name="__RequestVerificationToken"]').val()},data:JSON.stringify(g)}).done(function(e){t.success("Reservation has been created. Please check your account for more info","Reservation",{timeOut:0,onTap:function(){window.location.reload()}})}).fail(function(e){var n=e.responseJSON.message;t.error(n,"Reservation",{timeOut:0,onTap:function(){}})}).always(function(){})}else t.warning("Enter venue for event","Validation Error",{timeOut:0});else t.warning("Enter title for event","Validation Error",{timeOut:0})},e.get("Reservations/?handler=Packages").then(function(e){n.lookups.packages=e.data},function(e){t.error(JSON.stringify(e),"Contact Administrator")}),e.get("Reservations/?handler=Pricing").then(function(e){n.pricing=e.data,n.originalPricing=angular.copy(e.data)},function(e){t.error(JSON.stringify(e),"Contact Administrator")});e.get("Reservations/?handler=Reservations").then(function(e){for(var t=[],n=0;n<e.data.length;n++){var a=e.data[n];t.push({title:a.title,start:r.a.fullCalendar.moment(a.dateStart),end:r.a.fullCalendar.moment(a.dateEnd)})}r()("#calendar").fullCalendar({header:{center:"month,agendaWeek"},defaultView:"month",minTime:"06:00:00",maxTime:"24:00:00",events:t})},function(e){t.error(JSON.stringify(e),"Contact Administrator")})}f.$inject=["$http","toastr"],l.controller("reservationController",f);n(146),n(148);function p(e,t,n,a){const r=this;function o(){e.get("api/customer/reservations").then(function(e){r.items=e.data;for(var t=0;t<r.items.length;t++){var n=r.items[t];n.toNow=d()(n.dateStart).fromNow(),0===n.reservationStatus&&(n.reservationStatusText="Pending"),1===n.reservationStatus&&(n.reservationStatusText="Payment Sent"),2===n.reservationStatus&&(n.reservationStatusText="Payment Accepted"),3===n.reservationStatus&&(n.reservationStatusText="Payment Rejected"),4===n.reservationStatus&&(n.reservationStatusText="Complete"),5===n.reservationStatus&&(n.reservationStatusText="Cancelled")}},function(e){alert("error occured")})}r.selectedItem=null,r.setSelectedItem=function(e){r.selectedItem=e},r.setPayment=function(){n.open({animation:!0,templateUrl:"modalPayment.html",controller:"ModalInstanceCtrl",size:"lg",backdrop:"static",resolve:{paymentDetail:function(){return{totalPrice:r.selectedItem.totalPrice,amountPaid:r.selectedItem.amountPaid,referenceNumber:r.selectedItem.referenceNumber}}}}).result.then(function(n){var a={id:r.selectedItem.reservationId,amountPaid:n.amountPaid,referenceNumber:n.referenceNumber};e.post("api/customer/reservation/pay",a).then(function(e){t.success("Reservation paid","Payment Success"),o()},function(e){t.danger("An error occured while updating reservation","Payment Failed")})})},r.setCreditCardPayment=function(){n.open({animation:!0,templateUrl:"modalCreditCardPayment.html",controller:"ModalInstanceCtrlCreditCardPayment",size:"lg",resolve:{paymentDetail:function(){return{reservationId:r.selectedItem.reservationId,totalPrice:r.selectedItem.totalPrice,amountPaid:r.selectedItem.amountPaid,referenceNumber:r.selectedItem.referenceNumber}}}}).opened.then(function(){a(133)})},r.viewReservation=function(){n.open({animation:!0,templateUrl:"modalViewReservation.html",controller:"viewReservationModalController",size:"lg",resolve:{reservation:function(){return r.selectedItem}}})},r.cancelReservation=function(){confirm("Are you sure you want to cancel this reservation?")&&e.post(`api/customer/cancelReservation/${r.selectedItem.reservationId}`).then(function(e){t.info("Reservation cancelled","Cancellation"),o()},function(e){t.warning("An error occured while updating reservation","Cancellation Failed")})},o()}function j(e,t,n,a,r){e.payment=s.a.copy(r),e.payment.amountPaid=e.payment.totalPrice,e.ok=function(){if(1===e.payment.paymentType){if(e.payment.amountPaid<e.payment.totalPrice)return void a.warning("Amount Paid is less that Total price","Really?")}else{var n=.3*e.payment.totalPrice;if(e.payment.amountPaid<n)return void a.warning("Amount Paid is less than the 30% of total price","Really?")}t.close(e.payment)},e.cancel=function(){t.dismiss("cancel")},e.paymentTypeChanged=function(){var t=e.payment.paymentType,n=e.payment.totalPrice;"2"===t&&(n*=.3),e.suggestedPaymentAmount=n}}function g(e,t,n,a){e.reservation=s.a.copy(a),e.ok=function(){t.close()},e.cancel=function(){t.dismiss("cancel")}}function v(e,t,n,a,r,o){e.payment=s.a.copy(o),e.payment.amountPaid=e.payment.totalPrice,e.ok=function(){e.payment.amountPaid<e.payment.totalPrice?r.warning("Amount Paid is less that Total price","Really?"):t.close(e.payment)},e.cancel=function(){t.dismiss("cancel")},e.init=function(){var t=Stripe("pk_test_yzpzINlD1C0NHX8O1Qjaos6o"),n=t.elements().create("card",{style:{base:{fontSize:"16px",color:"#32325d"}}});n.mount(s.a.element("#card-element")[0]),n.addEventListener("change",function(e){var t=s.a.element("#card-errors")[0];e.error?t.textContent=e.error.message:t.textContent=""}),document.getElementById("payment-form").addEventListener("submit",function(r){r.preventDefault(),t.createToken(n).then(function(t){var n;t.error?document.getElementById("card-errors").textContent=t.error.message:(n=t.token,a.post(`api/customer/reservations/pay-with-stripe/?token=${n.id}&amount=${e.payment.totalPrice}&reservationId=${e.payment.reservationId}`).then(function(e){},function(e){alert(JSON.stringify(e))}))})})}}p.$inject=["$http","toastr","$uibModal","$timeout"],l.controller("myReservationsController",p),j.$inject=["$scope","$uibModalInstance","$filter","toastr","paymentDetail"],l.controller("ModalInstanceCtrl",j),g.$inject=["$scope","$uibModalInstance","toastr","reservation"],l.controller("viewReservationModalController",g),v.$inject=["$scope","$uibModalInstance","$filter","$http","toastr","paymentDetail"],l.controller("ModalInstanceCtrlCreditCardPayment",v)}});